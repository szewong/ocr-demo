<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Number Reader Web App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        #video, #canvas {
            display: none;
        }
        #captured-image {
            max-width: 100%;
            margin-top: 20px;
        }
        #recognized-text {
            font-size: 1.2em;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
        }
    </style>
</head>
<body>
    <h1>Number Reader</h1>
    <button id="start-camera">Take Picture</button>
    <video id="video" autoplay></video>
    <canvas id="canvas"></canvas>
    <img id="captured-image" src="" alt="Captured Image">
    <p id="recognized-text"></p>

    <!-- Include Tesseract.js via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2/dist/tesseract.min.js"></script>

    <script>
        const startCameraButton = document.getElementById('start-camera');
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const img = document.getElementById('captured-image');
        const recognizedText = document.getElementById('recognized-text');

        startCameraButton.addEventListener('click', function() {
            navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } })
                .then(stream => {
                    video.srcObject = stream;
                    video.play();
                    video.style.display = 'block';
                    startCameraButton.style.display = 'none';

                    // Wait for video to load metadata
                    video.addEventListener('loadedmetadata', function() {
                        // Set canvas dimensions to match video feed
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;

                        // Create a button to capture the image
                        const captureButton = document.createElement('button');
                        captureButton.innerText = 'Capture Image';
                        document.body.appendChild(captureButton);

                        captureButton.addEventListener('click', function() {
                            // Draw the current video frame onto the canvas
                            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
                            const imageDataURL = canvas.toDataURL('image/png');
                            img.src = imageDataURL;
                            img.style.display = 'block';

                            // Stop all video streams
                            video.pause();
                            video.srcObject.getTracks().forEach(track => track.stop());
                            video.style.display = 'none';
                            captureButton.style.display = 'none';

                            // Use Tesseract.js to recognize text from the image
                            Tesseract.recognize(
                                canvas,
                                'eng',
                                { logger: m => console.log(m) }
                            ).then(({ data: { text } }) => {
                                // Extract numbers using a regular expression
                                const numbers = text.match(/\d+/g);
                                if (numbers) {
                                    recognizedText.innerText = 'Numbers found: ' + numbers.join(', ');
                                } else {
                                    recognizedText.innerText = 'No numbers found.';
                                }
                            }).catch(err => {
                                console.error('OCR error:', err);
                                recognizedText.innerText = 'Error recognizing text.';
                            });
                        });
                    });
                })
                .catch(err => {
                    console.error('Error accessing camera: ' + err);
                    alert('Could not access the camera. Please allow camera access and try again.');
                });
        });
    </script>
</body>
</html>

